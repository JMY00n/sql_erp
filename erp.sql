-- 1. 제품 (ERP_PRODUCT)
CREATE TABLE ERP_PRODUCT (
    PRODUCT_ID NUMBER PRIMARY KEY,
    PRODUCT_NAME VARCHAR2(100) NOT NULL,
    DESCRIPTION VARCHAR2(100)
);

-- 2. 자재 (ERP_MATERIAL)
CREATE TABLE ERP_MATERIAL (
    MATERIAL_ID NUMBER PRIMARY KEY,
    MATERIAL_NAME VARCHAR2(100) NOT NULL,
    STOCK_QTY NUMBER DEFAULT 0
);

-- 3. BOM (ERP_BOM)
CREATE TABLE ERP_BOM (
    PRODUCT_ID NUMBER,
    MATERIAL_ID NUMBER,
    REQUIRED_QTY NUMBER NOT NULL,
    CONSTRAINT PK_ERP_BOM PRIMARY KEY (PRODUCT_ID, MATERIAL_ID),
    CONSTRAINT FK_BOM_PRODUCT FOREIGN KEY (PRODUCT_ID) REFERENCES ERP_PRODUCT(PRODUCT_ID),
    CONSTRAINT FK_BOM_MATERIAL FOREIGN KEY (MATERIAL_ID) REFERENCES ERP_MATERIAL(MATERIAL_ID)
);

-- 4. 완제품 재고 (ERP_INVENTORY)
CREATE TABLE ERP_INVENTORY (
    PRODUCT_ID NUMBER PRIMARY KEY,
    STOCK_QTY NUMBER DEFAULT 0,
    CONSTRAINT FK_INVEN_PRODUCT FOREIGN KEY (PRODUCT_ID) REFERENCES ERP_PRODUCT(PRODUCT_ID)
);

-- 5. 생산 주문 (ERP_PRODUCTION_ORDER)
CREATE TABLE ERP_PRODUCTION_ORDER (
    ORDER_ID NUMBER PRIMARY KEY,
    PRODUCT_ID NUMBER NOT NULL,
    ORDER_QTY NUMBER NOT NULL,
    ORDER_DATE DATE DEFAULT SYSDATE,
    CONSTRAINT FK_ORDER_PRODUCT FOREIGN KEY (PRODUCT_ID) REFERENCES ERP_PRODUCT(PRODUCT_ID)
);

-- 6. 생산 기록 (ERP_PRODUCTION_RECORD)
CREATE TABLE ERP_PRODUCTION_RECORD (
    RECORD_ID NUMBER PRIMARY KEY,
    ORDER_ID NUMBER NOT NULL,
    PRODUCED_QTY NUMBER NOT NULL,
    PRODUCED_DATE DATE DEFAULT SYSDATE,
    CONSTRAINT FK_RECORD_ORDER FOREIGN KEY (ORDER_ID) REFERENCES ERP_PRODUCTION_ORDER(ORDER_ID)
);

-- 7. 자재 입고 (ERP_MATERIAL_IN)
CREATE TABLE ERP_MATERIAL_IN (
    IN_ID NUMBER PRIMARY KEY,
    MATERIAL_ID NUMBER NOT NULL,
    IN_QTY NUMBER NOT NULL,
    IN_DATE DATE DEFAULT SYSDATE,
    CONSTRAINT FK_IN_MATERIAL FOREIGN KEY (MATERIAL_ID) REFERENCES ERP_MATERIAL(MATERIAL_ID)
);

-- 8. 자재 사용 내역 (ERP_MATERIAL_USAGE)
CREATE TABLE ERP_MATERIAL_USAGE (
    USAGE_ID NUMBER PRIMARY KEY,
    MATERIAL_ID NUMBER NOT NULL,
    USED_QTY NUMBER NOT NULL,
    USED_DATE DATE DEFAULT SYSDATE,
    PRODUCTION_RECORD_ID NUMBER,
    CONSTRAINT FK_USAGE_MATERIAL FOREIGN KEY (MATERIAL_ID) REFERENCES ERP_MATERIAL(MATERIAL_ID),
    CONSTRAINT FK_USAGE_RECORD FOREIGN KEY (PRODUCTION_RECORD_ID) REFERENCES ERP_PRODUCTION_RECORD(RECORD_ID)
);

-- 9. 배송/출고 (ERP_SHIPMENT)
CREATE TABLE ERP_SHIPMENT (
    SHIPMENT_ID NUMBER PRIMARY KEY,
    SHIPMENT_DATE DATE DEFAULT SYSDATE
);

-- 10. 배송 상세 (ERP_SHIPMENT_RECORD)
CREATE TABLE ERP_SHIPMENT_RECORD (
    SHIPMENT_RECORD_ID NUMBER PRIMARY KEY,
    SHIPMENT_ID NUMBER NOT NULL,
    PRODUCT_ID NUMBER NOT NULL,
    QTY NUMBER NOT NULL,
    CONSTRAINT FK_SHIP_REC_SHIP FOREIGN KEY (SHIPMENT_ID) REFERENCES ERP_SHIPMENT(SHIPMENT_ID),
    CONSTRAINT FK_SHIP_REC_PROD FOREIGN KEY (PRODUCT_ID) REFERENCES ERP_PRODUCT(PRODUCT_ID)
);

COMMIT;

-- 1. 제품 등록 (요청하신 세척기 4종)
INSERT INTO ERP_PRODUCT VALUES (101, '전기식 세척기1', '산업용 기본형 전기 세척기');
INSERT INTO ERP_PRODUCT VALUES (102, '전기식 세척기2', '고압 터보 전기 세척기');
INSERT INTO ERP_PRODUCT VALUES (103, '연료식 세척기1', '디젤 기반 이동식 세척기');
INSERT INTO ERP_PRODUCT VALUES (104, '연료식 세척기2', '대용량 보일러형 연료 세척기');

-- 2. 자재 등록 (세척기 부품)
INSERT INTO ERP_MATERIAL VALUES (201, '고압 펌프', 50);     -- 핵심 부품 (재고 50)
INSERT INTO ERP_MATERIAL VALUES (202, '전기 모터', 30);     -- 핵심 부품 (재고 30 - 부족 예상)
INSERT INTO ERP_MATERIAL VALUES (203, '가열 히터', 100);    -- 전기식용
INSERT INTO ERP_MATERIAL VALUES (204, '연료 탱크', 80);     -- 연료식용
INSERT INTO ERP_MATERIAL VALUES (205, '스테인리스 바디', 200); -- 공용
INSERT INTO ERP_MATERIAL VALUES (206, '컨트롤 패널', 150);   -- 공용
INSERT INTO ERP_MATERIAL VALUES (207, '바퀴 세트', 300);     -- 이동식용

-- 3. BOM 구성 (제품별 필요 자재)
-- [전기식 세척기1]: 펌프1, 모터1, 히터1, 바디1, 패널1
INSERT INTO ERP_BOM VALUES (101, 201, 1);
INSERT INTO ERP_BOM VALUES (101, 202, 1);
INSERT INTO ERP_BOM VALUES (101, 203, 1);
INSERT INTO ERP_BOM VALUES (101, 205, 1);
INSERT INTO ERP_BOM VALUES (101, 206, 1);

-- [전기식 세척기2]: 펌프2(고압), 모터2(고출력), 히터1, 바디1, 패널1
INSERT INTO ERP_BOM VALUES (102, 201, 2);
INSERT INTO ERP_BOM VALUES (102, 202, 2);
INSERT INTO ERP_BOM VALUES (102, 203, 1);
INSERT INTO ERP_BOM VALUES (102, 205, 1);
INSERT INTO ERP_BOM VALUES (102, 206, 1);

-- [연료식 세척기1]: 펌프1, 모터1, 탱크1, 바디1, 바퀴1
INSERT INTO ERP_BOM VALUES (103, 201, 1);
INSERT INTO ERP_BOM VALUES (103, 202, 1);
INSERT INTO ERP_BOM VALUES (103, 204, 1);
INSERT INTO ERP_BOM VALUES (103, 205, 1);
INSERT INTO ERP_BOM VALUES (103, 207, 1);

-- 4. 완제품 재고 초기화
INSERT INTO ERP_INVENTORY VALUES (101, 5);  -- 전기식1 5대
INSERT INTO ERP_INVENTORY VALUES (102, 2);  -- 전기식2 2대
INSERT INTO ERP_INVENTORY VALUES (103, 10); -- 연료식1 10대
INSERT INTO ERP_INVENTORY VALUES (104, 0);  -- 연료식2 재고 없음

-- 5. 생산 주문 (계획)
INSERT INTO ERP_PRODUCTION_ORDER VALUES (1001, 101, 10, TO_DATE('2025-12-01','YYYY-MM-DD')); -- 전기식1 10대 주문
INSERT INTO ERP_PRODUCTION_ORDER VALUES (1002, 103, 5, TO_DATE('2025-12-05','YYYY-MM-DD'));  -- 연료식1 5대 주문
INSERT INTO ERP_PRODUCTION_ORDER VALUES (1003, 101, 20, TO_DATE('2025-12-10','YYYY-MM-DD')); -- 전기식1 20대 주문

-- 6. 생산 기록 (실적)
INSERT INTO ERP_PRODUCTION_RECORD VALUES (5001, 1001, 10, TO_DATE('2025-12-03','YYYY-MM-DD')); -- 1001번 주문 전량 생산 완료
INSERT INTO ERP_PRODUCTION_RECORD VALUES (5002, 1002, 5, TO_DATE('2025-12-07','YYYY-MM-DD'));  -- 1002번 주문 전량 생산 완료

-- 7. 자재 입고 기록
INSERT INTO ERP_MATERIAL_IN VALUES (7001, 201, 50, TO_DATE('2025-11-20','YYYY-MM-DD')); -- 고압 펌프 입고
INSERT INTO ERP_MATERIAL_IN VALUES (7002, 202, 50, TO_DATE('2025-11-25','YYYY-MM-DD')); -- 전기 모터 입고

-- 8. 자재 사용 기록 (생산 5001번 - 전기식1 10대 생산에 대한 자재 소모)
-- 전기식1 1대당 펌프1, 모터1 소요 -> 10대니까 각각 10개씩 소모
INSERT INTO ERP_MATERIAL_USAGE VALUES (8001, 201, 10, TO_DATE('2025-12-03','YYYY-MM-DD'), 5001);
INSERT INTO ERP_MATERIAL_USAGE VALUES (8002, 202, 10, TO_DATE('2025-12-03','YYYY-MM-DD'), 5001);

-- 9. 배송/출고
INSERT INTO ERP_SHIPMENT VALUES (9001, TO_DATE('2025-12-14','YYYY-MM-DD'));
INSERT INTO ERP_SHIPMENT VALUES (9002, TO_DATE('2025-12-15','YYYY-MM-DD'));

-- 10. 배송 상세
INSERT INTO ERP_SHIPMENT_RECORD VALUES (91, 9001, 101, 3); -- 전기식1 3대 출고
INSERT INTO ERP_SHIPMENT_RECORD VALUES (92, 9001, 103, 2); -- 연료식1 2대 출고
INSERT INTO ERP_SHIPMENT_RECORD VALUES (93, 9002, 101, 2); -- 전기식1 2대 추가 출고

COMMIT;